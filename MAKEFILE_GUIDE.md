# Makefile ä½¿ç”¨æŒ‡å—

æœ¬é¡¹ç›®æä¾›äº†ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„ Makefileï¼ŒåŒ…å«å¼€å‘è¿‡ç¨‹ä¸­å¸¸ç”¨çš„å‘½ä»¤ã€‚

## ğŸ“‹ æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤

```bash
make help
```

è¿™ä¼šæ˜¾ç¤ºæ‰€æœ‰å¯ç”¨å‘½ä»¤åŠå…¶è¯´æ˜ã€‚

## ğŸš€ å¼€å‘ç›¸å…³å‘½ä»¤

### å®‰è£…ä¾èµ–

```bash
make install
```

ä½¿ç”¨ uv å®‰è£…é¡¹ç›®æ‰€æœ‰ä¾èµ–ã€‚

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
make dev
```

å¯åŠ¨ FastAPI å¼€å‘æœåŠ¡å™¨ï¼Œæ”¯æŒçƒ­é‡è½½ï¼š
- åœ°å€: http://0.0.0.0:8000
- æ–‡æ¡£: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

### å¯åŠ¨è°ƒè¯•æ¨¡å¼æœåŠ¡å™¨

```bash
make dev-debug
```

å¯åŠ¨å¼€å‘æœåŠ¡å™¨å¹¶å¼€å¯è¯¦ç»†æ—¥å¿—ã€‚

## ğŸ§ª æµ‹è¯•ç›¸å…³å‘½ä»¤

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
make test
```

è¿è¡Œæ‰€æœ‰æµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šã€‚

### è¿è¡Œç‰¹å®šç±»å‹çš„æµ‹è¯•

```bash
make test-unit          # å•å…ƒæµ‹è¯•
make test-integration   # é›†æˆæµ‹è¯•
make test-e2e          # ç«¯åˆ°ç«¯æµ‹è¯•
```

### ç›‘å¬æ¨¡å¼è¿è¡Œæµ‹è¯•

```bash
make test-watch
```

æ–‡ä»¶å˜æ›´æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•ã€‚

## ğŸ” ä»£ç è´¨é‡æ£€æŸ¥

### ä»£ç æ£€æŸ¥ï¼ˆLintï¼‰

```bash
make lint           # æ£€æŸ¥ä»£ç é—®é¢˜
make lint-fix       # æ£€æŸ¥å¹¶è‡ªåŠ¨ä¿®å¤
```

### ä»£ç æ ¼å¼åŒ–

```bash
make format
```

ä½¿ç”¨ Ruff æ ¼å¼åŒ–ä»£ç ã€‚

### ç±»å‹æ£€æŸ¥

```bash
make type-check
```

ä½¿ç”¨ MyPy è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚

### è¿è¡Œæ‰€æœ‰æ£€æŸ¥

```bash
make check
```

ä¾æ¬¡è¿è¡Œ lintã€format å’Œ type-checkã€‚

## ğŸ”— Pre-commit

### å®‰è£… pre-commit hooks

```bash
make pre-commit-install
```

å®‰è£…åï¼Œæ¯æ¬¡ git commit å‰ä¼šè‡ªåŠ¨è¿è¡Œä»£ç æ£€æŸ¥ã€‚

### æ‰‹åŠ¨è¿è¡Œ pre-commit

```bash
make pre-commit-run
```

å¯¹æ‰€æœ‰æ–‡ä»¶è¿è¡Œ pre-commit æ£€æŸ¥ã€‚

## ğŸ—„ï¸ æ•°æ®åº“ç›¸å…³å‘½ä»¤

### åˆ›å»ºè¿ç§»æ–‡ä»¶

```bash
make db-migrate msg="æ·»åŠ ç”¨æˆ·è¡¨"
```

åˆ›å»ºæ–°çš„æ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼ˆéœ€è¦æä¾›æè¿°ä¿¡æ¯ï¼‰ã€‚

### å‡çº§æ•°æ®åº“

```bash
make db-upgrade
```

å°†æ•°æ®åº“å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚

### é™çº§æ•°æ®åº“

```bash
make db-downgrade
```

å°†æ•°æ®åº“é™çº§ä¸€ä¸ªç‰ˆæœ¬ã€‚

### æŸ¥çœ‹è¿ç§»å†å²

```bash
make db-history
```

æ˜¾ç¤ºæ‰€æœ‰è¿ç§»è®°å½•ã€‚

### æŸ¥çœ‹å½“å‰ç‰ˆæœ¬

```bash
make db-current
```

æ˜¾ç¤ºå½“å‰æ•°æ®åº“ç‰ˆæœ¬ã€‚

### é‡ç½®æ•°æ®åº“ï¼ˆå±é™©æ“ä½œï¼‰

```bash
make db-reset
```

âš ï¸ è­¦å‘Šï¼šè¿™ä¼šåˆ é™¤æ‰€æœ‰æ•°æ®å¹¶é‡æ–°åº”ç”¨è¿ç§»ï¼

## ğŸ§¹ æ¸…ç†ç›¸å…³å‘½ä»¤

### æ¸…ç†ä¸´æ—¶æ–‡ä»¶

```bash
make clean
```

æ¸…ç†ä»¥ä¸‹æ–‡ä»¶å’Œç›®å½•ï¼š
- `__pycache__`
- `*.pyc`, `*.pyo`
- `.pytest_cache`
- `.ruff_cache`
- `.mypy_cache`
- æµ‹è¯•è¦†ç›–ç‡æ–‡ä»¶

### æ·±åº¦æ¸…ç†

```bash
make clean-all
```

é™¤äº†æ¸…ç†ä¸´æ—¶æ–‡ä»¶å¤–ï¼Œè¿˜ä¼šåˆ é™¤è™šæ‹Ÿç¯å¢ƒã€‚

## ğŸ Python Shell

### å¯åŠ¨ Python Shell

```bash
make shell
```

å¯åŠ¨ Python äº¤äº’å¼ç¯å¢ƒã€‚

### å¯åŠ¨ IPython Shell

```bash
make shell-ipython
```

å¯åŠ¨ IPythonï¼ˆéœ€è¦å…ˆå®‰è£… ipythonï¼‰ã€‚

## ğŸ³ Docker ç›¸å…³å‘½ä»¤

### æ„å»º Docker é•œåƒ

```bash
make docker-build
```

### è¿è¡Œ Docker å®¹å™¨

```bash
make docker-run
```

### åœæ­¢ Docker å®¹å™¨

```bash
make docker-stop
```

## ğŸ“¦ å…¶ä»–å®ç”¨å‘½ä»¤

### å¯¼å‡ºä¾èµ–

```bash
make requirements
```

å°†ä¾èµ–å¯¼å‡ºåˆ° `requirements.txt` æ–‡ä»¶ã€‚

### æŸ¥çœ‹æ—¥å¿—

```bash
make logs
```

å®æ—¶æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼ˆéœ€è¦é…ç½®æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼‰ã€‚

### æŸ¥çœ‹é¡¹ç›®ä¿¡æ¯

```bash
make info
```

æ˜¾ç¤ºé¡¹ç›®å’Œä¾èµ–ç‰ˆæœ¬ä¿¡æ¯ã€‚

## ğŸ”§ å¸¸ç”¨å·¥ä½œæµ

### å¼€å§‹å¼€å‘

```bash
make install           # å®‰è£…ä¾èµ–
make pre-commit-install # å®‰è£… pre-commit hooks
make dev              # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```

### æäº¤ä»£ç å‰

```bash
make check            # è¿è¡Œæ‰€æœ‰æ£€æŸ¥
make test             # è¿è¡Œæµ‹è¯•
```

### æ•°æ®åº“è¿ç§»å·¥ä½œæµ

```bash
# 1. ä¿®æ”¹æ¨¡å‹
# 2. åˆ›å»ºè¿ç§»
make db-migrate msg="ä¿®æ”¹ç”¨æˆ·è¡¨"

# 3. åº”ç”¨è¿ç§»
make db-upgrade

# 4. å¦‚æœæœ‰é—®é¢˜ï¼Œå›æ»š
make db-downgrade
```

### æ¸…ç†å’Œé‡æ–°å¼€å§‹

```bash
make clean-all        # æ·±åº¦æ¸…ç†
make install          # é‡æ–°å®‰è£…
make db-upgrade       # åº”ç”¨æ•°æ®åº“è¿ç§»
make dev              # å¯åŠ¨æœåŠ¡
```

## ğŸ’¡ æç¤ºå’ŒæŠ€å·§

1. **ä½¿ç”¨ tab è¡¥å…¨**ï¼šåœ¨ç»ˆç«¯ä¸­è¾“å…¥ `make` åæŒ‰ Tab é”®å¯ä»¥çœ‹åˆ°æ‰€æœ‰å¯ç”¨å‘½ä»¤ã€‚

2. **ç»„åˆå‘½ä»¤**ï¼šå¯ä»¥ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼š
   ```bash
   make clean && make lint && make test
   ```

3. **æŸ¥çœ‹å‘½ä»¤è¯¦æƒ…**ï¼šåœ¨ Makefile ä¸­æŸ¥çœ‹å…·ä½“å‘½ä»¤çš„å®ç°ã€‚

4. **è‡ªå®šä¹‰å‘½ä»¤**ï¼šå¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚åœ¨ Makefile ä¸­æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤ã€‚

5. **é¢œè‰²è¾“å‡º**ï¼šMakefile ä½¿ç”¨é¢œè‰²è¾“å‡ºï¼Œä½¿ä¿¡æ¯æ›´æ˜“è¯»ã€‚

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: make å‘½ä»¤ä¸å¯ç”¨ï¼Ÿ
A: ç¡®ä¿ç³»ç»Ÿå·²å®‰è£… makeï¼š
```bash
# Ubuntu/Debian
sudo apt-get install make

# macOS (é€šå¸¸å·²é¢„è£…)
xcode-select --install
```

### Q: uv å‘½ä»¤ä¸å¯ç”¨ï¼Ÿ
A: ç¡®ä¿å·²å®‰è£… uvï¼š
```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

### Q: æƒé™é”™è¯¯ï¼Ÿ
A: æŸäº›å‘½ä»¤å¯èƒ½éœ€è¦æ‰§è¡Œæƒé™ï¼š
```bash
chmod +x scripts/*.sh
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [README.md](./README.md) - é¡¹ç›®æ€»ä½“ä»‹ç»
- [API_USAGE_EXAMPLES.md](./API_USAGE_EXAMPLES.md) - API ä½¿ç”¨ç¤ºä¾‹
- [AGENTS.md](./AGENTS.md) - å¼€å‘è§„èŒƒå’Œæäº¤è§„èŒƒ
